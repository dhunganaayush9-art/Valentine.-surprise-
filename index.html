<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Surprise ğŸ’–</title>
<style>
  body {
    font-family: Arial;
    text-align: center;
    background: #ffe6eb;
    padding: 25px;
    margin: 0;
  }
  button {
    padding: 12px 22px;
    margin: 8px;
    font-size: 17px;
    border: none;
    border-radius: 10px;
    background: #ff4d6d;
    color: white;
    cursor: pointer;
  }
  textarea {
    width: 85%;
    height: 80px;
    font-size: 16px;
    padding: 10px;
    margin: 10px 0;
  }
  table {
    margin: 20px auto;
    border-collapse: collapse;
  }
  td, th {
    border: 1px solid #ff4d6d;
    padding: 8px 12px;
  }
  #finalScreen { display:none; }
</style>
</head>
<body>

<h2 id="question"></h2>
<div id="area"></div>
<div id="finalScreen">
  <h2>ğŸ†ğŸˆ Animations, fireworks and balloons ğŸˆğŸ†</h2>
  <button id="marryBtn">Weâ€™ll be married soon, my love ğŸ’•</button>
  <br><br>
  <button onclick="showAnswers()">View All Answers</button>
  <div id="answersTable"></div>
</div>

<script>
let step = 0;
let answers = [];

// Flow definition with branching & inputs
const flow = [
  {q:"I know, I make you angry sometimes, but you know what? You make me the happiest person alive. And as we start this day, I want to start by asking â€” will you be my Valentine?", o:["Yes","Definitely yes"]},
  {q:"I love you â¤ï¸", o:["I love you too","I love you more"]},
  {q:"Have you changed your mind yet?", o:["Not yet","I am changing slowlyâ€¦ slowlyâ€¦ going slowlyâ€¦ not yet"], inputFor:"Not yet"},
  {q:"Okayâ€¦ Iâ€™m waiting for the day to come ğŸ’•\nHappy Rose Day, my love ğŸŒ¹", o:["Happy Rose Day to you too","My rose ğŸŒ¹"]},
  {q:"I want to be with you forever. I see forever in your eyes. I promise to take care of you every single day.", o:["I'm always yours","Yeah, you sometimes make me angry, but I know you love me"]},
  {q:"This is our first Valentineâ€™s together, but I promise to be with you till the very end, and weâ€™ll celebrate all the Valentineâ€™s together. I promise.", o:["Are you sure?","I know you will be with me forever"]},
  {branch:{
    "Are you sure?": {msg:"Iâ€™m 100% sure â€” more sure than I will ever be â¤ï¸", o:["Okay"]},
    "I know you will be with me forever": {msg:"I know you trust me, and I trust you with all my heart. I will never break your heart â¤ï¸", o:["ğŸ¥¹ğŸ’–","ğŸ˜­â¤ï¸"]}
  }},
  {q:"I love you. I love you more than anything else in this world.", input:true},
  {q:"Last questionâ€¦ will you marry me?", input:true}
];

// Render current step
function render(){
  let f = flow[step];
  document.getElementById("area").innerHTML = "";

  // Branch step
  if(f.branch){
    let last = answers[answers.length-1];
    let b = f.branch[last];
    if(!b){ alert("Error: No branch found for last answer!"); return; }
    document.getElementById("question").innerText = b.msg;
    showOptions(b.o);
    return;
  }

  document.getElementById("question").innerText = f.q;

  if(f.o){
    showOptions(f.o);
  } else if(f.input || f.inputFor){
    document.getElementById("area").innerHTML = `<textarea id="txt" placeholder="Write your reply here"></textarea><br><button onclick="submitInput()">Submit</button>`;
  }
}

// Show buttons for options
function showOptions(opts){
  let a = document.getElementById("area");
  opts.forEach(x=>{
    let b = document.createElement("button");
    b.innerText = x;
    b.onclick = ()=>choose(x);
    a.appendChild(b);
  });
}

// Handle option click
function choose(ans){
  answers.push(ans);
  step++;
  if(step < flow.length) render();
  else showFinal();
}

// Handle typed input
function submitInput(){
  let v = document.getElementById("txt").value.trim();
  if(!v){ alert("Please write something! â¤ï¸"); return; }
  answers.push(v);
  step++;
  if(step < flow.length) render();
  else showFinal();
}

// Final screen with animations and buttons
function showFinal(){
  document.getElementById("question").style.display="none";
  document.getElementById("area").style.display="none";
  let f = document.getElementById("finalScreen");
  f.style.display="block";
  document.getElementById("marryBtn").onclick = ()=>alert("Session ended. All answers are recorded!");
}

// Show all answers in a neat table
function showAnswers(){
  let table = `<table><tr><th>Step</th><th>Answer</th></tr>`;
  answers.forEach((a,i)=>{ table += `<tr><td>${i+1}</td><td>${a}</td></tr>`; });
  table += `</table>`;
  document.getElementById("answersTable").innerHTML = table;
}

// Render first question immediately
window.onload = render;
</script>

</body>
</html>
